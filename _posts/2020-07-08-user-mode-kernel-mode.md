---
layout: post
title: ðŸ“”ã€æ“ä½œç³»ç»Ÿã€‘ç”¨æˆ·æ€ä¸Žå†…æ ¸æ€
date: 2020/7/7 08:00
---

> æ›´å¤šé¢è¯•é¢˜æ€»ç»“è¯·çœ‹ï¼š[ðŸ—‚ã€é¢è¯•é¢˜ã€‘æŠ€æœ¯é¢è¯•é¢˜æ±‡æ€»]({%post_url 2020-07-08-tech-interview%})

## ä¸ºä½•è¦åŒºåˆ†ç”¨æˆ·æ€å’Œå†…æ ¸æ€
æœ€ç®€å•çš„è¿è¡Œç¨‹åºçš„æ–¹å¼æ˜¯â€œç›´æŽ¥æ‰§è¡Œâ€ï¼Œå³ç›´æŽ¥åœ¨ CPU ä¸Šæ‰§è¡Œä»»æ„ç¨‹åºã€‚ç›´æŽ¥æ‰§è¡Œçš„é—®é¢˜æ˜¯ï¼š
1. å¦‚ä½•é™åˆ¶ä»£ç è¡Œä¸ºï¼Ÿæ¯”å¦‚ç¦æ­¢ï¼šè®¾ç½®ç‰¹æ®Šå¯„å­˜å™¨çš„å€¼ã€è®¿é—®å­˜å‚¨å™¨çš„ä»»æ„ä½ç½®ã€I/O è¯·æ±‚ã€ç”³è¯·æ›´å¤šç³»ç»Ÿèµ„æºç­‰
2. åœ¨è¿è¡Œè¿™ä¸ªç¨‹åºçš„æ—¶å€™ï¼Œå¦‚ä½•åˆ‡æ¢åˆ°å¦ä¸€ä¸ªç¨‹åºï¼Ÿè¿›ç¨‹è°ƒåº¦åº”è¯¥æ˜¯ OS æ‰æœ‰çš„æƒé™

å› æ­¤å¼•å…¥ç”¨æˆ·æ€å’Œå†…æ ¸æ€å’Œä¸¤ç§æ¨¡å¼ã€‚ç”¨æˆ·æ€æ— æ³•æ‰§è¡Œå—é™æ“ä½œï¼Œå¦‚ I/O è¯·æ±‚ï¼Œæ‰§è¡Œè¿™äº›æ“ä½œä¼šå¼•å‘å¼‚å¸¸ã€‚æ ¸å¿ƒæ€åªèƒ½ç”±æ“ä½œç³»ç»Ÿè¿è¡Œï¼Œå¯ä»¥æ‰§è¡Œç‰¹æƒæ“ä½œã€‚ç”¨æˆ·ç¨‹åºé€šè¿‡**ç³»ç»Ÿè°ƒç”¨** system call æ‰§è¡Œè¿™äº›ç‰¹æƒæ“ä½œã€‚OS æ‰§è¡Œå‰ä¼šåˆ¤æ–­è¿›ç¨‹æ˜¯å¦æœ‰**æƒé™**æ‰§è¡Œç›¸åº”çš„æŒ‡ä»¤ã€‚

åŒºåˆ†ç”¨æˆ·æ€å’Œæ ¸å¿ƒæ€çš„æ‰§è¡Œæœºåˆ¶ç§°ä¸ºâ€œå—é™ç›´æŽ¥æ‰§è¡Œâ€ï¼ˆLimited Direct Executionï¼‰ã€‚

## ä»€ä¹ˆæ—¶å€™ä¼šé™·å…¥å†…æ ¸æ€
ç³»ç»Ÿè°ƒç”¨ï¼ˆtrapï¼‰ã€ä¸­æ–­ï¼ˆinterruptï¼‰å’Œå¼‚å¸¸ï¼ˆexceptionï¼‰ã€‚

ç³»ç»Ÿè°ƒç”¨æ˜¯ç”¨æˆ·è¿›ç¨‹ä¸»åŠ¨å‘èµ·çš„æ“ä½œã€‚å‘èµ·ç³»ç»Ÿè°ƒç”¨ï¼Œé™·å…¥å†…æ ¸ï¼Œç”±æ“ä½œç³»ç»Ÿæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œç„¶åŽå†è¿”å›žåˆ°è¿›ç¨‹ã€‚

ä¸­æ–­å’Œå¼‚å¸¸æ˜¯è¢«åŠ¨çš„ï¼Œæ— æ³•é¢„æµ‹å‘ç”Ÿæ—¶æœºã€‚ä¸­æ–­åŒ…æ‹¬ I/O ä¸­æ–­ã€å¤–éƒ¨ä¿¡å·ä¸­æ–­ã€å„ç§å®šæ—¶å™¨å¼•èµ·çš„æ—¶é’Ÿä¸­æ–­ç­‰ã€‚å¼‚å¸¸åŒ…æ‹¬ç¨‹åºè¿ç®—å¼•èµ·çš„å„ç§é”™è¯¯å¦‚é™¤ 0ã€ç¼“å†²åŒºæº¢å‡ºã€ç¼ºé¡µç­‰ã€‚

åœ¨ç³»ç»Ÿçš„å¤„ç†ä¸Šï¼Œä¸­æ–­å’Œå¼‚å¸¸ç±»ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡ä¸­æ–­å‘é‡è¡¨æ¥æ‰¾åˆ°ç›¸åº”çš„å¤„ç†ç¨‹åºè¿›è¡Œå¤„ç†ã€‚åŒºåˆ«åœ¨äºŽï¼Œä¸­æ–­æ¥è‡ªå¤„ç†å™¨å¤–éƒ¨ï¼Œä¸æ˜¯ç”±ä»»ä½•ä¸€æ¡ä¸“é—¨çš„æŒ‡ä»¤é€ æˆï¼Œè€Œå¼‚å¸¸æ˜¯æ‰§è¡Œå½“å‰æŒ‡ä»¤çš„ç»“æžœã€‚


## C è®¿é—®ç©ºæŒ‡é’ˆä¼šä¸ä¼šé™·å…¥å†…æ ¸æ€
ä¼šã€‚

è®¿é—®æŒ‡é’ˆç›¸å½“äºŽè®¿é—®ä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œç¡¬ä»¶ä¼šå°†è™šæ‹Ÿåœ°å€æ˜ å°„åˆ°çœŸå®žçš„ç‰©ç†å†…å­˜ã€‚å¦‚æžœæ˜ å°„å¤±è´¥ï¼Œç¡¬ä»¶ä¼šæŠ›å‡ºä¸€ä¸ªæ®µé”™è¯¯**å¼‚å¸¸**ï¼ˆpage fault exceptionï¼‰ï¼Œæ­¤æ—¶ä¼š**ä»Žç”¨æˆ·æ€è½¬ä¸ºå†…æ ¸æ€**è¿›è¡Œå¤„ç†ã€‚

OS ä¼šåœ¨ä¸­æ–­æè¿°ç¬¦è¡¨ä¸­ï¼Œæ‰¾åˆ°å¤„ç† page fault exception çš„ä¸­æ–­å‘é‡ï¼Œæ‰§è¡Œç›¸åº”çš„ handlerã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒOS ä¼šæŠ›å‡ºä¸€ä¸ª `SIGSEGV` ä¿¡å·ç»™è¿›ç¨‹ï¼Œä¸­æ­¢è¿›ç¨‹ï¼Œæ‰“å°å‡º debug ä¿¡æ¯ã€‚

> [å‚è€ƒ - StackOverflow](https://stackoverflow.com/questions/12645647/what-happens-in-os-when-we-dereference-a-null-pointer-in-c)  
>  the CPU raises a page fault error which **traps into** a predefined point at the kernel, the kernel examines what happened, and reacts accordingly 